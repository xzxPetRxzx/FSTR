# FSTR
    Опиание:

Данный проект предназначен для ФСТР для обработки данных о перевалах.
Этот проект представляет из себя серверное приложение на основе  Django rest framework обрабатывающее JSON запросы клиентского приложения через API.
В данном приложении используется БД Postagre SQL.
Реализовано 4 основных метода для обработки данных

Описание и примеры использования реализованных методов:

1) post метод submit_data:
      Реализовывает запись данных в БД на основании POST JSON запроса по адресу .../submitData/. 
      Пример запроса:
          {
            "beauty_title": "перевал ",
            "title": "Пхия",
            "other_titles": "Триев",
            "connect": "пример", 
            "add_time": "2021-09-22 13:18:13",
            "user": {
                      "email": "qwerty@mail.ru", 		
                      "fam": "Пупкин",
		                  "name": "Василий",
		                  "otc": "Иванович",
                      "phone": "+79997949270}, 
             "coords":{
                      "latitude": "45.3842",
                      "longitude": "7.1525",
                      "height": "1213"},
             "level":{
                       "winter": "", 
                       "summer": "1А",
                       "autumn": "1А",
                        "spring": ""},
 
              "images": [
                        {"data":"<картинка1>", "title":"Седловина"},
                        {"data":"<картинка2>", "title":"Подъём"}
                        ]
             }
      Принимаемые данные:  
         "user" - Данные пользователя
              "email" - электронная почта пользователя(проверяется формат почты, обязательна)
              "fam" - фамилия пользователя(текстовая строка, обязательна)
              "name" - имя пользователя (текстовая строка, обязательна)
              "otc" - отчество пользователя(текстовая строка, обязательна)
              "phone": телефон пользователя(обязательна)
          "coords" - Данные о кординатах
              "latitude" - широта(десятичное число до 6 занков после запятой, обязательна)
              "longitude"- долгота(десятичное число до 6 занков после запятой, обязательна)
              "height" - Высота над уровнем моря(целочиленное, обязаьельное)
           
           "level" - Данные о проходимости в разные времена года
                "winter" - зимний период(текстовое, необязательное)
                "summer" - летний период (текстовое, необязательное)
                "autumn" - осенний период (текстовое, необязательное)
                "spring"- весенний период (текстовое, необязательное)
            "images" - Данные подгружаемых фотографий
                "data" - данные фотографии(обязательное)
                "title" - заголовок (текстовое, обязатльное)
            "beauty_title" - заголовок 1(текстовое, обязатльное)
            "title" - заголовок 2(текстовое, обязатльное)
            "other_titles - заголовок 3(текстовое, обязатльное)
            "connect" - дополнительные данные(текстовое, необязатльное)
            "add_time" - Дата добавления(дата, обязательное)
            
      На основании запроса в базе данных производится верификация полуенных в запросе данных и если она не проходится успешно возвращает ответ типа:
    {
    "status": "400",
    "message": "Bad request: {<детали ошибки>}",
    "id": "None"
    }
      
      В случае успешного выполнения верификации данных проверяется существование пользователя в базе данных. Если пользователь отсутствует в базе данных он создается.
     В случае наличия пользователя в базе данных запись создается от его имени. После создания записи возвращается ответ типа:
    {
    "status": "200",
    "message": "None",
    "id": "<id созданной записи>"
    }
    
      В случае ошибки обработки ответа сервером возвращается ответ типа:
    {
    "status": "500",
    "message": "Ошибка сервера: <данные ошибки>",
    "id": "None"
    }
2) get метод list_for_user:
    Метод предназначен для вывода всех записей для определенного пользователя. Он доступен по запросу типа .../submitData/?user__email=<email пользователя>
При отсутствии или неверном запросе возвращает ответ "Empty response".
При верном запросе возвращает записи объектов
      
      Пример выполнения:
      [
    {
        "id": 2,
        "beauty_title": "перевал",
        "title": "Пхия",
        "other_titles": "Триев",
        "connect": "",
        "add_time": "2021-09-22 13:18:13",
        "status": "new",
        "user": {
            "email": "qwerty@mail.ru",
            "fam": "Пупкин",
            "name": "Василий",
            "otc": "Иванович",
            "phone": "+79997949270"
        },
        "coords": {
            "latitude": "45.384200",
            "longitude": "7.152500",
            "height": 1213
        },
        "level": {
            "winter": "",
            "summer": "1А",
            "autumn": "1А",
            "spring": ""
        },
        "images": [
            {
                "data": "",
                "title": "Седловина"
            },
            {
                "data": "",
                "title": "Подъём"
            },
            {
                "data": "",
                "title": "Подъём2"
            },
            {
                "data": "",
                "title": "Седловина2"
            }
        ]
    },
    {
        "id": 3,
        "beauty_title": "пер.",
        "title": "Пхия",
        "other_titles": "Триев",
        "connect": "",
        "add_time": "2021-09-22 13:18:13",
        "status": "new",
        "user": {
            "email": "qwerty@mail.ru",
            "fam": "Пупкин",
            "name": "Василий",
            "otc": "Иванович",
            "phone": "+79997949270"
        },
        "coords": {
            "latitude": "45.384200",
            "longitude": "7.152500",
            "height": 1200
        },
        "level": {
            "winter": "",
            "summer": "1А",
            "autumn": "1А",
            "spring": ""
        },
        "images": [
            {
                "data": "",
                "title": "Седловина"
            },
            {
                "data": "",
                "title": "Подъём"
            }
        ]
    },
   ]
   
3) get метод get_record:  
    Предназначен для получения конкретной записи по ее id. Доступен по адресу .../submitData/<id записи>
    При выполнении возвращает запись из БД по ее id:
        пример:
  {
    "id": 2,
    "beauty_title": "перевал",
    "title": "Пхия",
    "other_titles": "Триев",
    "connect": "",
    "add_time": "2021-09-22 13:18:13",
    "status": "new",
    "user": {
        "email": "qwerty@mail.ru",
        "fam": "Пупкин",
        "name": "Василий",
        "otc": "Иванович",
        "phone": "+79997949270"
    },
    "coords": {
        "latitude": "45.384200",
        "longitude": "7.152500",
        "height": 1213
    },
    "level": {
        "winter": "",
        "summer": "1А",
        "autumn": "1А",
        "spring": ""
    },
    "images": [
        {
            "data": "",
            "title": "Седловина"
        },
        {
            "data": "",
            "title": "Подъём"
        },
        {
            "data": "",
            "title": "Подъём2"
        },
        {
            "data": "",
            "title": "Седловина2"
        }
    ]
}

    В случае отсутствия записи c даннsv id возвращает ответ:
        {
        "detail": "Not found."
        }
        
4) post метод update_record:
     Предназначен для обновления информации в конкретной записи по ее id. Доступен по адресу .../submitData/<id записи>
     Запрос для обновления аналогичен запросу в методе submit data
     В случае успешного обновления возвращает ответ:
          {
          "state": "1"
          }
     В случае ошибки при выполнении:
          {
          "state": "0",
          "message": <причина ошибки>
          }
     
